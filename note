curl -O https://ftp.unicamp.br/pub/centos/8/BaseOS/x86_64/os/Packages/stunnel-5.56-5.el8_3.x86_64.rpm

curl -O https://dl.rockylinux.org/vault/rocky/8.4/BaseOS/x86_64/os/Packages/stunnel-5.56-5.el8_3.x86_64.rpm

openssl s_client -connect 10.52.73.123:8089 -tlsextdebug -msg

export OPENSSL_NO_DEFAULT_ZLIB=1

ldd /usr/bin/<your-binary> | grep zlib



es â€” if Sysdig is flagging this based solely on OpenSSL support for compression (e.g. zlib built into the binary), then itâ€™s a false positive unless:
	â€¢	TLS sessions are actually negotiated with compression enabled.
	â€¢	Or the application explicitly enables compression in SSL context (which your openssl s_client output shows is not happening).

â¸»

ğŸ” What Sysdig Is Likely Doing:

Sysdig scans binaries and linked libraries. It likely found:
	â€¢	libz.so or zlib support linked in OpenSSL (ldd $(which openssl) or strings /usr/lib64/libssl.so | grep -i deflate)
	â€¢	Or saw OpenSSL built with compression support (--with-zlib)

But that doesnâ€™t mean compression is used â€” it just means itâ€™s theoretically possible.

â¸»

âœ… Your Evidence:

From your screenshot:



__

Compression: NONE


This means during actual TLS handshake:
	â€¢	No compression was negotiated
	â€¢	No vulnerability path is exploitable in practice

â¸»

ğŸ›¡ What to Tell Your Security Team

â€œSysdig flagged DEFLATE support likely because OpenSSL has zlib linked, but our TLS sessions do not use compression. This has been validated using openssl s_client â€” the session shows Compression: NONE. We believe this is a false positive.â€

You can optionally add:
	â€¢	OPENSSL_NO_DEFAULT_ZLIB=1 to your container or OpenSSL environment to enforce it even if unused
	â€¢	Harden with OpenSSL built without zlib if youâ€™re recompiling (not likely on RHCOS)

â¸»

Would you like me to generate a formal justification note or attach a sample mitigation memo?









âœ… Youâ€™re not vulnerable to active TLS compression leakage.

Hereâ€™s what matters from the output:
	â€¢	Line: Compression: NONE
ğŸ‘‰ This explicitly confirms that no compression was negotiated.
	â€¢	No compression methods or DEFLATE are mentioned in the ClientHello or ServerHello exchange.
	â€¢	Cipher suite is modern (ECDHE-RSA-AES256-GCM-SHA384), which does not include compression.

â¸»

ğŸ“Œ Why is this still showing up in vulnerability scans?

Qualys and similar tools sometimes flag compression vulnerabilities just because the underlying OpenSSL library includes zlib support, even if:
	â€¢	Compression isnâ€™t used.
	â€¢	No service actively enables it.

â¸»

ğŸ”§ Recommendation (Actionable Summary)


